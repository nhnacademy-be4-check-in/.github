[![Hits](https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2Fnhnacademy-be4-ckin&count_bg=%237BB5DB&title_bg=%232D2D2D&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false)](https://hits.seeyoufarm.com)

# 📖 CKIN

<div align="center">
  <a href="https://www.ckin.store">
    <img width="40%" heigth="40%" style="text-align: center" 
      src="https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/3ad87d06-6600-490a-afaa-8360c2cc7970"/>
  </a> 

  <h3> NHN Academy 4기 - CKIN 팀 </h3>

| <a href="https://github.com/f1v3-dev"><img src="https://github.com/f1v3-dev.png" width="100px"><br/>정승조</a> | <a href="https://github.com/dduneon"><img src="https://github.com/dduneon.png" width="100px"><br/>김준현</a> | <a href="https://github.com/devhomh"><img src="https://github.com/devhomh.png" width="100px"><br/>이진우</a> | <a href="https://github.com/nayoseb"><img src="https://github.com/nayoseb.png" width="100px"><br/>나국로</a> | <a href="https://github.com/nueag"> <img src ="https://github.com/nueag.png" width="100px"><br/>이가은</a> | <a href="https://github.com/unhas01"><img src="https://github.com/unhas01.png" width="100px"><br/>박경서(TA)</a> 
|-------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|

</div>

<br/>

## 🌎 Repository

- [API](https://github.com/nhnacademy-be4-ckin/ckin-api)
- [FRONT](https://github.com/nhnacademy-be4-ckin/ckin-front)
- [COUPON](https://github.com/nhnacademy-be4-ckin/ckin-coupon)
- [AUTH](https://github.com/nhnacademy-be4-ckin/ckin-auth)
- [GATEWAY](https://github.com/nhnacademy-be4-ckin/ckin-gateway)
- [BATCH](https://github.com/nhnacademy-be4-ckin/ckin-batch)
- [EUREKA](https://github.com/nhnacademy-be4-ckin/ckin-eureka)
- [MANAGEMENT](https://github.com/nhnacademy-be4-ckin/ckin-management)
- [STUDY](https://github.com/nhnacademy-be4-ckin/study-materials)

---

# 🚩 Table of Contents

- [About the Project](#-about-the-project)
    - [Technologies](#technologies)
    - [Project Management](#project-management)
- [Features](#-features)

# 📄 About the Project

**프로젝트 기간 : 2024.02.07. ~ 2024.03.28**

스프링 부트와 클라우드 서비스를 활용한 온라인 도서 쇼핑몰 프로젝트입니다.

## 개발 환경

### 개발 도구

- Intellij IDEA - Ultimate

### Language

- [Java 11 LTS (Eclipse Temurin)](https://adoptium.net/temurin/releases/?version=11)

### Build Tools

- Maven

### Develop

- [Spring Framework : 5.x](https://spring.io/)
- Spring Boot : 2.7.18
- Spring Cloud Config, Gateway, Netflix Eureka
- Spring Data JPA, Querydsl
- Spring Security
- Spring Rest Docs
- Spring Batch

### Test

- Junit5
- AssertJ
- Mockito
- SonarQube

### Database

- MySQL : 8.x
- Redis

### Search Engine

- Elastic Search : 7.x

### ERD

- ERDCloud

### NHN Cloud

- Instance
- Secure Key Manager
- Object Storage
- Load Balancer

### ETC.

- Dooray Hook Sender
- Toast UI

## Technologies

### Develop

![Apache Maven](https://img.shields.io/badge/Apache%20Maven-C71A36?style=for-the-badge&logo=Apache%20Maven&logoColor=white)
![Java](https://img.shields.io/badge/java-%23ED8B00.svg?style=for-the-badge&logo=openjdk&logoColor=white) ![Spring](https://img.shields.io/badge/spring-%236DB33F.svg?style=for-the-badge&logo=spring&logoColor=white) ![Spring Boot](https://img.shields.io/badge/Spring_Boot-%236DB33F.svg?style=for-the-badge&logo=spring-boot&logoColor=white) ![Spring Batch](https://img.shields.io/badge/Spring_Batch-%236DB33F.svg?style=for-the-badge&logo=spring&logoColor=white) ![Spring Eureka](https://img.shields.io/badge/Spring_Eureka-6DB33F.svg?style=for-the-badge&logo=spring&logoColor=white) ![Spring Cloud Gateway](https://img.shields.io/badge/Spring_Cloud_Gateway-6DB33F.svg?style=for-the-badge&logo=spring&logoColor=white) ![MySQL](https://img.shields.io/badge/mysql-4479A1.svg?style=for-the-badge&logo=mysql&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-black?style=for-the-badge&logo=JSON%20web%20tokens) ![Redis](https://img.shields.io/badge/redis-%23DD0031.svg?style=for-the-badge&logo=redis&logoColor=white) ![ElasticSearch](https://img.shields.io/badge/-ElasticSearch-005571?style=for-the-badge&logo=elasticsearch)

![Thymeleaf](https://img.shields.io/badge/Thymeleaf-%23005C0F.svg?style=for-the-badge&logo=Thymeleaf&logoColor=white) ![Bootstrap](https://img.shields.io/badge/bootstrap-%238511FA.svg?style=for-the-badge&logo=bootstrap&logoColor=white) ![JavaScript](https://img.shields.io/badge/javascript-%23323330.svg?style=for-the-badge&logo=javascript&logoColor=%23F7DF1E) ![jQuery](https://img.shields.io/badge/jquery-%230769AD.svg?style=for-the-badge&logo=jquery&logoColor=white)

### CI/CD

![Jenkins](https://img.shields.io/badge/jenkins-%232C5263.svg?style=for-the-badge&logo=jenkins&logoColor=white) ![GitHub Actions](https://img.shields.io/badge/github%20actions-%232671E5.svg?style=for-the-badge&logo=githubactions&logoColor=white) ![Linux](https://img.shields.io/badge/Linux-FCC624?style=for-the-badge&logo=linux&logoColor=black) ![Ubuntu](https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white) ![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white) ![Nginx](https://img.shields.io/badge/nginx-%23009639.svg?style=for-the-badge&logo=nginx&logoColor=white)

### Environment & Tools

![IntelliJ IDEA](https://img.shields.io/badge/IntelliJIDEA-000000.svg?style=for-the-badge&logo=intellij-idea&logoColor=white) ![Git](https://img.shields.io/badge/git-%23F05033.svg?style=for-the-badge&logo=git&logoColor=white) ![GitHub](https://img.shields.io/badge/github-%23121011.svg?style=for-the-badge&logo=github&logoColor=white) 
![SonarQube](https://img.shields.io/badge/SonarQube-black?style=for-the-badge&logo=sonarqube&logoColor=4E9BCD) ![SonarLint](https://img.shields.io/badge/SonarLint-CB2029?style=for-the-badge&logo=SONARLINT&logoColor=white) ![Postman](https://img.shields.io/badge/Postman-FF6C37?style=for-the-badge&logo=postman&logoColor=white)

### ER-Diagram

> CKIN ERD : https://www.erdcloud.com/d/9aZQ5oDB87BGD2v8k

- `ERDCloud` 활용

![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/be903ed1-65c4-4807-90b4-22c0cf6b7e81)


### Architecture

![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/a792dad2-74ac-40db-b155-677c482e50e7)


### CI/CD

![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/337babfb-d2ce-4106-973e-ca854647b431)


## Project Management

> Github에서 제공하는 `Projects`를 활용하여 프로젝트 관리

### Scrum

- 주마다 *Scurm Master*를 변경하는 방식으로 진행
- 매일 진행 예정 사항과 특이사항을 정리하여 **체계적인 프로젝트 진행**

![image](https://github.com/nhnacademy-be4-ckin/ckin-api/assets/84575041/b2077795-1819-4970-a014-b60ef67626e6)

### 일정관리

- *Road Map, Kanban* 활용
- 일정 관리 및 진행 사항 공유

*Road Map*
![image](https://github.com/nhnacademy-be4-ckin/ckin-api/assets/84575041/77971750-8c97-4c8e-81f7-b72e7ecd43f0)

*Kanban*
![image](https://github.com/nhnacademy-be4-ckin/ckin-api/assets/84575041/b12199e3-8ba1-4546-a322-d5ad34575969)

### Test Coverage

- 정적 코드 분석 도구인 `SonarQube`를 활용하였습니다.
- 목표 : Coverage 80% 

#### API
![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/f331b1f5-3679-4379-be8b-1d1c69499ab5)

#### Coupon
![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/edb307eb-351e-49a2-818b-83f62ee0b6cb)



### Spring Rest Docs

#### API : https://www.ckin.store/api-docs 
![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/7ee21db9-aff4-47b4-8065-fb4a55ca996d)

#### Coupon : https://www.ckin.store/coupon-docs
![image](https://github.com/nhnacademy-be4-ckin/.github/assets/84575041/f1d2abd7-96d8-4f73-8a1a-0f7da098deee)


### 기술 공유

> CKIN Study Materials : https://github.com/nhnacademy-be4-ckin/study-materials

- 프로젝트를 진행하면서 학습 내용 공유 저장소를 이용하여 습득한 기술을 공유하였습니다.
- 또한, `Issue`, `Discussion`을 통해 해결하기 어려운 문제, 버그를 고친 방법 등을 팀원들과 공유하였습니다.

### Conventions & Strategy

- [깃 브랜치 전략](https://github.com/nhnacademy-be4-ckin/ckin-api/wiki/%EA%B9%83-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EC%A0%84%EB%9E%B5)
- [커밋 컨벤션](https://github.com/nhnacademy-be4-ckin/ckin-api/wiki/%EC%BB%A4%EB%B0%8B-%EC%BB%A8%EB%B2%A4%EC%85%98)
- [자바 컨벤션](https://github.com/nhnacademy-be4-ckin/ckin-api/wiki/%EC%9E%90%EB%B0%94-%EC%BB%A8%EB%B2%A4%EC%85%98)
- [상태 코드](https://github.com/nhnacademy-be4-ckin/ckin-api/wiki/%EC%83%81%ED%83%9C-%EC%BD%94%EB%93%9C)

# 🎨 Features

## [🙋🏻‍♂️ 정승조](https://github.com/f1v3-dev)

### 주문

> 관련 PR : [주문 생성](https://github.com/nhnacademy-be4-ckin/ckin-front/pull/91), [주문 취소](https://github.com/nhnacademy-be4-ckin/ckin-front/pull/181)

- 회원/비회원 주문 처리
- 회원 주문
    - 포인트, 쿠폰 사용 가능
    - 적용할 수 있는 쿠폰
- 포장 가능한 도서인 경우 포장지 선택 가능
- 배송지 입력 ([Daum Postcode API](http://postcode.map.daum.net/guide))
- 주문 상세 내역 조회

### 주문 취소

- 주문 배송 상태가 `배송중(READ)` 인 경우에만 주문 취소 가능
- 결제 완료된 주문
    - Toss Payment API를 통한 결제 취소
- 회원 주문 취소
    - 사용 포인트, 적립금 고려하여 처리

### 결제

> 관련 PR : [토스 페이먼츠 API 연동](https://github.com/nhnacademy-be4-ckin/ckin-front/pull/107), [결제 - 생성](https://github.com/nhnacademy-be4-ckin/ckin-api/pull/99)

- 주문 완료 후 [Toss Payment API](https://developers.tosspayments.com)를 통한 결제 진행
- 결제 성공/실패에 따른 처리
    - 결제 완료 시 API 서버에 결제 정보 저장
    - 또한, 결제 완료된 주문의 결제 상태를 완료(PAID)로 변경
- `@Transactional의 propagation` 옵션을 통해 트랜잭션 처리

### 포인트

> 관련 Discussion : [결제 완료시 포인트 적립 처리를 어떻게 해야될까?](https://github.com/nhnacademy-be4-ckin/ckin-api/discussions/133)

- 회원 가입 시 포인트 적립 정책에 따른 포인트 적립
- 주문시 사용한 포인트 차감 및 포인트 내역 생성
- 결제시 회원 등급에 따른 포인트 적립
- 회원의 포인트 적립/차감 내역 조회

### etc.

- `Spring Cloud Netflix Eureka`
    - 서비스 디스커버리 및 로드밸런싱
    - 무중단 배포 구현
- Spring AOP - `@Member` 어노테이션을 통한 Model 객체에 회원 정보 주입
- `@ExceptionHandler`를 통한 전역 예외 처리
- 배송비 정책 관리
- 포인트 적립 정책 관리
- 포장 정책 관리

## [김준현](https://github.com/dduneon)

## [이진우](https://github.com/devhomh)
### 멤버
- `Spring Security`
  - 회원의 권한에 따른 페이지 인가
  - 로그인/로그아웃
  - 페이코 연동을 이용하여 소셜 로그인
  - `JWT`를 이용하여 자격증명 및 서버통신
  - `Redis`를 이용하여 매핑된 회원 정보 조회
  - Gateway에서 Backend과 통신하기 전, 인증/인가
  - 인증된 정보를 이용하여 `JWT` 발급/재발급 ([CKIN-Auth](https://github.com/nhnacademy-be4-ckin/ckin-auth))
- 회원가입
  - 계정 중복검사 및 비밀번호 유효성 검사
  - Dooray Hook을 이용한 SMS 인증
- 마이페이지를 통하여 회원 정보 조회, 수정, 탈퇴

### 주소
- DAUM 주소 API를 사용하여 회원의 주소 등록
- 마이페이지를 통하여 회원의 주소 관리 (CRUD)

### 등급
- 관리자페이지에서 등급 관리 (CRUD)
- 마이페이지에서 회원의 등급 조회 및 등급 정책 확인

## [나국로](https://github.com/nayoseb)
### 상품
- 관리자 페이지에서 상품 등록, 수정, 삭제
- 상품 등록 시 editor 적용(toast ui)
- 썸네일 수정 기능

### 저자
- 저자 등록, 수정, 삭제

### 카테고리
- 카테고리 생성, 수정, 조회
- 부모 카테고리, 자식 카테고리로 이뤄진 3depth 형태
- 메인페이지의 카테고리 캐싱(Redis)

### 파입업로드
- Object Storage 저장

### 마이페이지 리뷰
- 마이페이지에서 해당 유저가 작성한 리뷰 조회 및 수정

## [이가은](https://github.com/nueag)
### 쿠폰
- 생일쿠폰, 웰컴쿠폰, 도서쿠폰, 카테고리쿠폰 발급
- 쿠폰 정책, 쿠폰 템플릿, 쿠폰 생성, 조회, 수정, 삭제
### 웰컴쿠폰 지급
- 회원가입시 웰컴쿠폰 자동 지급
- 웰컴쿠폰 지급이 실패해도 회원가입은 성공하도록 처리
### Spring Batch로 생일쿠폰 매달 1일에 지급
- JPA(Hibernate), JDBC Templates, MyBatis 중 bulk insert가 가능하고 기본키 전략을 사용하지 않는 Mybatis 선택
- `MyBatisPagingItemReader` 사용

### 리뷰
- 리뷰 등록
- 리뷰 이미지 다중화를 통해 한 리뷰에 여러 이미지를 등록할 수 있도록 처리
- 주문한 도서에 대해서만 리뷰를 작성할 수 있도록 처리
- 사용기술 : Spring Data JPA, Query DSL, Thymeleaf, javascript 등

### 도서 캐싱
- 접속 빈도가 높은 메인페이지의 도서를 Redis에 저장
- 만료시간을 하루로 설정하고 갱신하여 처리
- 사용기술: Redis

## 공통 작업

- JUnit5를 활용한 테스트 코드 작성
- `Spring Rest Docs`를 활용한 API 문서화
- CI/CD 환경 구성 (`Jenkins`, `GitHub Actions`)
- `SonarQube`를 통한 정적 코드 분석
